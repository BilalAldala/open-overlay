/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkOverlayEditor"] = self["webpackChunkOverlayEditor"] || []).push([["src_browser-renderer_index_js"],{

/***/ "./src/browser-renderer/OpenOverlayOverlay.js":
/*!****************************************************!*\
  !*** ./src/browser-renderer/OpenOverlayOverlay.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utilities.js */ \"./src/browser-renderer/utilities.js\");\n/* harmony import */ var _ScriptingContext_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ScriptingContext.js */ \"./src/browser-renderer/ScriptingContext.js\");\n\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n\n // sends events:\n// assets-changed - fires whenever the assets array is changed, including when the overlay is first loaded\n// load - fires when initial loading is complete, meaning all any elements have preloaded and initial assets have loaded\n\nclass OpenOverlayOverlay extends HTMLElement {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_assets\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_assetLoadPromise\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_loadedAssets\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_settings\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_preloadPromises\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_slot\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_scriptingContext\", void 0);\n\n    this._preloadPromises = [];\n    this.onElementPreloading = this.onElementPreloading.bind(this);\n    this.loadAssetsAsync = this.loadAssetsAsync.bind(this);\n    this.assetsAvailable = this.assetsAvailable.bind(this);\n    this.executeScripts = this.executeScripts.bind(this);\n    this.resetScripts = this.resetScripts.bind(this); // watch for child layers to emit preloading events\n\n    this.addEventListener(\"preloading\", this.onElementPreloading);\n  }\n\n  connectedCallback() {\n    this.style.visibility = \"hidden\";\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"settings\", null, () => this._settings, value => {\n      this._settings = value;\n\n      if (this._scriptingContext) {\n        this._scriptingContext.updateSettings(value);\n      }\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"executeScriptsOnLoad\", true, () => this._executeScriptsOnLoad, value => {\n      if (this._executeScriptsOnLoad == value) return;\n      this._executeScriptsOnLoad = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"assets\", null, () => this._assets, value => {\n      // if setting assets to the same source object we had before, do nothing\n      if (this._assets == value) return;\n      this._assets = value;\n      this._assetLoadPromise = this.loadAssetsAsync(value);\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"scripts\", null, () => this._scripts, value => {\n      if (this._scripts == value) return;\n      this._scripts = value;\n    });\n    requestAnimationFrame(async () => {\n      // wait for all preloads to complete before displaying the overlay's contents\n      if (this._preloadPromises) await Promise.all(this._preloadPromises); // wait for all assets to load as well\n\n      if (this._assetLoadPromise) await this._assetLoadPromise;\n      this.style.visibility = \"visible\";\n      if (this._executeScriptsOnLoad) this.executeScripts(); // and emit a load event\n\n      this.dispatchEvent(new Event(\"load\"));\n    });\n  }\n\n  disconnectedCallback() {\n    // clean up assetUrls\n    for (const assetUrl of this._assetUrls) URL.revokeObjectURL(assetUrl);\n  }\n\n  onElementPreloading(evt) {\n    if (evt.detail.promise) this._preloadPromises.push(evt.detail.promise);\n  }\n\n  findAsset(id) {\n    if (!this._loadedAssets) return null;\n    return this._loadedAssets.find(r => r.id == id);\n  }\n\n  assetsAvailable() {\n    return this._loadedAssets != null;\n  }\n\n  loadAssetsAsync(assets) {\n    // if our current asset list has any objectUrls, we need to revoke them to clean up\n    if (this._loadedAssets) for (const asset of this._loadedAssets) URL.revokeObjectURL(asset.objectUrl);\n    this._loadedAssets = null; // whenever assets are set, immediately generate the assetUrls (asynchronously)\n    // then fire off an assets-changed event when it's done\n    // if there's an assetLoadPromise that hasn't resolved, we're going to cancel it\n\n    if (this._assetLoadPromise) this._assetLoadPromise.cancelled = true; // load each asset and collect the promises\n\n    const pendingPromises = Object.entries(assets).map(([assetKey, assetValue]) => {\n      const asset = _objectSpread(_objectSpread({}, assetValue), {}, {\n        // to make string comparison easier, we'll prepend a # to the id\n        id: \"#\" + assetKey\n      });\n\n      return fetch(asset.src).then(res => {\n        return res.blob().then(blob => {\n          asset.objectUrl = URL.createObjectURL(blob);\n          return asset;\n        });\n      }, error => {\n        console.error(\"Failed to load asset: \" + error);\n        asset.error = error;\n        return asset;\n      });\n    }); // when all assets have loaded, resolve a promise\n\n    const assetLoadPromise = Promise.all(pendingPromises).then(assets => {\n      // if we've cancelled this by setting assets again quickly, bail out\n      if (assetLoadPromise.cancelled) return; // clean up the load promise since it's fulfilled\n\n      this._assetLoadPromise = null; // set locally\n\n      this._loadedAssets = assets; // and tell everyone assets have changed\n\n      this.dispatchEvent(new CustomEvent(\"assets-changed\"));\n    });\n    return assetLoadPromise;\n  }\n\n  executeScripts() {\n    if (this._scriptingContext) {\n      console.error(\"You must call resetScripts() before executing scripts again.\");\n      return;\n    }\n\n    const scriptingContext = new _ScriptingContext_js__WEBPACK_IMPORTED_MODULE_2__.default(this, this._scripts, this._assets, this._settings);\n    this._scriptingContext = scriptingContext;\n    return scriptingContext;\n  }\n\n  resetScripts() {\n    if (!this._scriptingContext) {\n      console.error(\"No current scripting context to reset.\");\n      return;\n    }\n\n    this._scriptingContext.destroy();\n\n    this._scriptingContextId = null;\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-overlay\", OpenOverlayOverlay);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayOverlay);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/OpenOverlayOverlay.js?");

/***/ }),

/***/ "./src/browser-renderer/OpenOverlayRenderer.js":
/*!*****************************************************!*\
  !*** ./src/browser-renderer/OpenOverlayRenderer.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utilities.js */ \"./src/browser-renderer/utilities.js\");\n/* harmony import */ var _jsonRenderer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./jsonRenderer.js */ \"./src/browser-renderer/jsonRenderer.js\");\n/* harmony import */ var _OpenOverlayOverlay_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./OpenOverlayOverlay.js */ \"./src/browser-renderer/OpenOverlayOverlay.js\");\n\n\n\n\n\nclass OpenOverlayRenderer extends HTMLElement {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_overlayContainer\", void 0);\n\n    this._overlays = []; // uses a shadow root\n\n    this.attachShadow({\n      mode: \"open\"\n    });\n    const style = document.createElement(\"style\"); // 1) host styles\n    // 2) default styles for overlays, which will always be the immediate children of the overlay-container\n    // 3) default styles for layers, which will always be the direct children of overlays\\\n\n    style.innerHTML = \"\\\r\n        :host { width:100%;height:100%;display: block; }\\\r\n        :host([hidden]) { display: none; }\\\r\n        overlay-container { width:100%;height:100%; }\\\r\n        overlay-container > openoverlay-overlay { display: block; width: 100%; height: 100%; }\\\r\n        openoverlay-overlay > * { display: block; position: absolute; box-sizing: border-box; object-fit: contain; object-position: center center; }\\\r\n        \";\n    this.shadowRoot.append(style); // add the overlay container\n\n    this._overlayContainer = document.createElement(\"overlay-container\");\n    this.shadowRoot.append(this._overlayContainer);\n  } // #region HTMLElement\n\n\n  static get observedAttributes() {\n    return [];\n  }\n\n  connectedCallback() {\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"overlays\", [], () => this._overlays, value => {\n      this._overlays = value; // binds the overlays to the DOM\n\n      (0,_jsonRenderer_js__WEBPACK_IMPORTED_MODULE_2__.renderOverlayArray)(this._overlayContainer, value);\n    });\n  }\n\n  disconnectedCallback() {}\n\n  attributeChangedCallback(name, oldValue, newValue) {} // #endregion\n\n\n}\n\nif (window.customElements) window.customElements.define(\"openoverlay-renderer\", OpenOverlayRenderer);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayRenderer);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/OpenOverlayRenderer.js?");

/***/ }),

/***/ "./src/browser-renderer/OpenOverlayStage.js":
/*!**************************************************!*\
  !*** ./src/browser-renderer/OpenOverlayStage.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n\n\nclass OpenOverlayStage extends HTMLElement {\n  static get observedAttributes() {\n    return [\"width\", \"height\"];\n  }\n\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_contentWidth\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_contentHeight\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_slot\", void 0);\n\n    this.attachShadow({\n      mode: \"open\"\n    });\n    const hostStyle = document.createElement(\"style\");\n    hostStyle.textContent = \":host { display: block; position: relative; }\\n:host([hidden]) { display: none; }\";\n    const slot = document.createElement(\"slot\");\n    slot.style.display = \"block\";\n    slot.style.transformOrigin = \"top left\";\n    this.shadowRoot.append(hostStyle, slot);\n    this._slot = slot;\n    this._contentWidth = parseFloat(this.getAttribute(\"width\"));\n    this._contentHeight = parseFloat(this.getAttribute(\"height\"));\n    this.onWindowResized = this.onWindowResized.bind(this);\n  }\n\n  onWindowResized() {\n    // if not connected, do nothing\n    if (!this.isConnected) return null;\n    const rect = this.shadowRoot.host.getBoundingClientRect(); // default width/height to 1920x1080\n\n    const targetWidth = isNaN(this._contentWidth) ? 1920 : this._contentWidth;\n    const targetHeight = isNaN(this._contentHeight) ? 1080 : this._contentHeight;\n    let scale;\n    if (rect.height / rect.width < targetHeight / targetWidth) scale = rect.height / targetHeight;else scale = rect.width / targetWidth; // center in the stage\n\n    const offsetX = (rect.width - targetWidth * scale) / 2;\n    const offsetY = (rect.height - targetHeight * scale) / 2;\n    this._slot.style.width = targetWidth + \"px\";\n    this._slot.style.height = targetHeight + \"px\";\n    this._slot.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;\n  }\n\n  connectedCallback() {\n    // watch for window resize events\n    window.addEventListener(\"resize\", this.onWindowResized); // and trigger a resize event for initial sizing\n\n    this.onWindowResized();\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener(\"resize\", this.onWindowResized);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name == \"width\") {\n      this.contentWidth = parseFloat(newValue);\n      this.onWindowResized();\n      return;\n    }\n\n    if (name == \"height\") {\n      this.contentHeight = parseFloat(newValue);\n      this.onWindowResized();\n      return;\n    }\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-stage\", OpenOverlayStage);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayStage);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/OpenOverlayStage.js?");

/***/ }),

/***/ "./src/browser-renderer/ScriptingContext.js":
/*!**************************************************!*\
  !*** ./src/browser-renderer/ScriptingContext.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _jsonRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./jsonRenderer.js */ \"./src/browser-renderer/jsonRenderer.js\");\n\n\nconst IMPORT_REGEX = /(import (.+ from )?[\"'])(\\.\\/)(.+)([\"'])/g;\n\nconst compileScript = (scriptingContextId, scriptName, scripts, assets, scriptUrls) => {\n  let scriptText;\n  let requiresCompile;\n\n  if (scriptName.startsWith(\"asset:\")) {\n    const asset = assets[scriptName];\n\n    if (asset) {\n      scriptText = atob(asset.src.substring(28));\n      console.log({\n        asset,\n        scriptText\n      });\n      requiresCompile = false;\n    }\n  } else {\n    scriptText = scripts[scriptName];\n    requiresCompile = true;\n  }\n\n  if (!scriptText) throw \"Could not find script or asset: \" + scriptName;\n  let blob;\n\n  if (!requiresCompile) {\n    blob = new Blob([`//# sourceURL=${scriptingContextId}/openoverlay/${scriptName}\\n${scriptText}`], {\n      type: \"text/javascript\"\n    });\n  } else {\n    const compiledScript = scriptText.replace(IMPORT_REGEX, (match, pre, pre2, dotSlash, importedScriptName, post) => {\n      // check to see if we've already compiled this script, and if so, return it's url\n      // otherwise, compile the imported script\n      const dependencyUrl = scriptUrls[importedScriptName] || compileScript(scriptingContextId, importedScriptName, scripts, assets, scriptUrls);\n      return pre + dependencyUrl + post;\n    });\n    blob = new Blob([`//# sourceURL=${scriptingContextId}/openoverlay/${scriptName}\\nconst context = window._openoverlayscriptingengine.contexts[${scriptingContextId}];\\nconst { setTimeout, setInterval } = context;\\n${compiledScript}`], {\n      type: \"text/javascript\"\n    });\n  } // now that we have a fully compiled script, create the blob and return a url\n\n\n  const scriptUrl = URL.createObjectURL(blob);\n  scriptUrls[scriptName] = scriptUrl;\n  return scriptUrl;\n};\n\nclass ScriptingContext extends EventTarget {\n  get assets() {\n    return this._assets;\n  }\n\n  get settings() {\n    return this._settings;\n  }\n\n  get overlay() {\n    return this._overlayDOM;\n  }\n\n  constructor(overlayDOM, scripts, assets, settings) {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_id\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_overlayDOM\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_scripts\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_assets\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_settings\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_timeouts\", []);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_intervals\", []);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_scriptUrls\", {});\n\n    this.setTimeout = this.setTimeout.bind(this);\n    this.setInterval = this.setInterval.bind(this);\n    this.updateSettings = this.updateSettings.bind(this);\n    if (!window._openoverlayscriptingengine) throw \"Could not find window._openoverlayscriptingengine\";\n    this._id = window._openoverlayscriptingengine.lastContextId++;\n    this._overlayDOM = overlayDOM;\n    this._scripts = scripts;\n    this._assets = assets;\n    this._settings = settings || {}; // default settings to an empty object\n    // pull in some methods for scripts to use\n\n    this.renderLayer = _jsonRenderer_js__WEBPACK_IMPORTED_MODULE_1__.renderLayer; // save this scripting context to the global scope\n\n    window._openoverlayscriptingengine.contexts[this._id] = this; // compile scripts\n\n    let compiledMainJs;\n\n    try {\n      compiledMainJs = compileScript(this._id, \"main.js\", scripts, assets, this._scriptUrls); // compileScript returns a blob: url - to execute it, we just import it.\n      // webpackIgnore prevents webpack from trying to parse this\n\n      import(\n      /* webpackIgnore: true */\n      compiledMainJs).catch(err => {\n        console.log(`Error executing script:\\n${err.stack}`, {\n          t: typeof err,\n          lineNumber: err.lineNumber\n        });\n      });\n    } catch (err) {\n      console.log(`Error compiling script:\\n${err}`);\n    }\n  }\n\n  setTimeout(callback, delay) {\n    // call JS's builtin function\n    const timeoutId = setTimeout(callback, delay);\n\n    this._timeouts.push(timeoutId);\n  }\n\n  setInterval(callback, period) {\n    // call JS's builtin function\n    const intervalId = setInterval(callback, period);\n\n    this._intervals.push(intervalId);\n  }\n\n  updateSettings(settings) {\n    this._settings = settings;\n    this.dispatchEvent(new CustomEvent(\"settings-changed\"));\n  }\n\n  destroy() {\n    // emit an event for scripts to clean themselves up\n    this.dispatchEvent(new CustomEvent(\"destroy\")); // clear timeouts/intervals\n\n    for (const timeout of this._timeouts) clearTimeout(timeout);\n\n    for (const interval of this._intervals) clearInterval(interval); // release any scriptUrls\n\n\n    for (const scriptUrl of Object.values(this._scriptUrls)) URL.revokeObjectURL(scriptUrl); // delete the script context from global state\n\n\n    delete window._openoverlayscriptingengine.contexts[this._id];\n  }\n\n}\n\nif (!window._openoverlayscriptingengine) {\n  window._openoverlayscriptingengine = {\n    lastContextId: 1,\n    contexts: {}\n  };\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ScriptingContext);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/ScriptingContext.js?");

/***/ }),

/***/ "./src/browser-renderer/elements.js":
/*!******************************************!*\
  !*** ./src/browser-renderer/elements.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _elements_OpenOverlayIframe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./elements/OpenOverlayIframe.js */ \"./src/browser-renderer/elements/OpenOverlayIframe.js\");\n/* harmony import */ var _elements_OpenOverlayImage_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./elements/OpenOverlayImage.js */ \"./src/browser-renderer/elements/OpenOverlayImage.js\");\n/* harmony import */ var _elements_OpenOverlayRectangle_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./elements/OpenOverlayRectangle.js */ \"./src/browser-renderer/elements/OpenOverlayRectangle.js\");\n/* harmony import */ var _elements_OpenOverlayText_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./elements/OpenOverlayText.js */ \"./src/browser-renderer/elements/OpenOverlayText.js\");\n/* harmony import */ var _elements_OpenOverlayVideo_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./elements/OpenOverlayVideo.js */ \"./src/browser-renderer/elements/OpenOverlayVideo.js\");\n\n\n\n\n\nconst styleCategories = {\n  POSITIONABLE: [\"rect\"],\n  STANDARD: [\"border\", \"backgroundColor\", \"opacity\", \"padding\", \"shadow\", \"filters\", \"cornerClip\", \"3dtransform\"],\n  TEXT: [\"font\", \"letterSpacing\", \"textStroke\", \"textShadow\", \"lineHeight\"],\n  FITTABLE: [\"autoFit\"]\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  image: {\n    domElementName: \"openoverlay-image\",\n    name: \"Image\",\n    icon: \"media\",\n    primative: true,\n    preserveAspect: true,\n    parameters: [{\n      name: \"url\",\n      displayName: \"Url/Asset\",\n      type: \"assetUrl\",\n      accept: \"image/*\",\n      inline: true\n    }],\n    allowedStyles: [...styleCategories.POSITIONABLE, ...styleCategories.FITTABLE, ...styleCategories.STANDARD],\n    defaultStyle: {\n      top: 0,\n      left: 0,\n      width: 400,\n      height: 400\n    }\n  },\n  iframe: {\n    domElementName: \"openoverlay-iframe\",\n    name: \"Iframe\",\n    icon: \"globe-network\",\n    primative: true,\n    preserveAspect: false,\n    parameters: [{\n      name: \"url\",\n      type: \"assetUrl\",\n      displayName: \"Url/Asset\",\n      accept: \"text/html\"\n    }],\n    allowedStyles: [...styleCategories.POSITIONABLE, ...styleCategories.FITTABLE, ...styleCategories.STANDARD]\n  },\n  rectangle: {\n    domElementName: \"openoverlay-rectangle\",\n    name: \"Rectangle\",\n    icon: \"square\",\n    preserveAspect: false,\n    primative: true,\n    parameters: [],\n    allowedStyles: [...styleCategories.POSITIONABLE, ...styleCategories.STANDARD],\n    defaultStyle: {\n      top: 0,\n      left: 0,\n      width: 640,\n      height: 360,\n      backgroundColor: \"#FF0000\"\n    }\n  },\n  text: {\n    domElementName: \"openoverlay-text\",\n    name: \"Text\",\n    icon: \"new-text-box\",\n    preserveAspect: false,\n    primative: true,\n    parameters: [{\n      \"name\": \"text\",\n      \"displayName\": \"Content\",\n      \"type\": \"textarea\",\n      \"defaultValue\": \"text\",\n      \"immediate\": true\n    }],\n    allowedStyles: [...styleCategories.POSITIONABLE, ...styleCategories.TEXT, ...styleCategories.STANDARD],\n    defaultStyle: {\n      top: 0,\n      left: 0,\n      width: 400,\n      height: 400,\n      fontFamily: \"Arial\",\n      fontSize: \"60px\",\n      color: \"rgba(255,255,255,1)\",\n      whiteSpace: \"pre\"\n    }\n  },\n  video: {\n    domElementName: \"openoverlay-video\",\n    name: \"Video\",\n    icon: \"video\",\n    primative: true,\n    preserveAspect: true,\n    parameters: [{\n      \"name\": \"url\",\n      \"displayName\": \"Url/Asset\",\n      \"type\": \"assetUrl\",\n      \"accept\": \"video/*\",\n      inline: true\n    }, {\n      \"name\": \"volume\",\n      \"type\": \"slider\",\n      \"displayName\": \"Volume\",\n      \"defaultValue\": 100,\n      inline: true\n    }, {\n      \"name\": \"playing\",\n      \"type\": \"checkbox\",\n      \"displayName\": \"Playing\",\n      \"defaultValue\": true,\n      inline: true,\n      width: 50\n    }, {\n      \"name\": \"loop\",\n      \"type\": \"checkbox\",\n      \"displayName\": \"Loop\",\n      \"defaultValue\": false,\n      inline: true,\n      width: 50\n    }],\n    allowedStyles: [...styleCategories.POSITIONABLE, ...styleCategories.FITTABLE, ...styleCategories.STANDARD],\n    defaultStyle: {\n      top: 0,\n      left: 0,\n      width: 1280,\n      height: 720\n    }\n  }\n});\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/OpenOverlayIframe.js":
/*!************************************************************!*\
  !*** ./src/browser-renderer/elements/OpenOverlayIframe.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities.js */ \"./src/browser-renderer/utilities.js\");\n/* harmony import */ var _elementBase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_elementBase.js */ \"./src/browser-renderer/elements/_elementBase.js\");\n\n\n\n\nclass OpenOverlayIframe extends _elementBase_js__WEBPACK_IMPORTED_MODULE_2__.default {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_iframe\", void 0);\n\n    this._iframe = document.createElement(\"iframe\");\n    this._iframe.style = \"height: 100%; width: 100%; object-fit: inherit; object-position: inherit\";\n    this.onAssetsChanged = this.onAssetsChanged.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.append(this._iframe);\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"src\", null, () => this._src, value => {\n      // unreference prior asset if needed\n      if (this._src && this._src.startsWith(\"#\")) this.unreferenceAsset(\"src\"); // handle asset references (starting with #)\n\n      if (value != null && value.startsWith(\"#\")) {\n        // ensure assets are available before proceeding\n        if (this._overlay.assetsAvailable()) {\n          const asset = this._overlay.findAsset(value);\n\n          if (asset != null) {\n            this.referenceAsset(\"src\", value);\n            this._iframe.src = asset.objectUrl;\n          } else {\n            console.error(\"Could not find asset \" + value);\n            this._iframe.src = null;\n          }\n        }\n      } else {\n        this._iframe.src = value;\n      }\n\n      if (value) {\n        const iframeLoadPromise = new Promise(resolve => {\n          const onLoad = () => {\n            this._iframe.removeEventListener(\"load\", onLoad);\n\n            resolve();\n          };\n\n          this._iframe.addEventListener(\"load\", onLoad);\n        });\n        this.dispatchEvent(new CustomEvent(\"preloading\", {\n          detail: {\n            promise: iframeLoadPromise\n          },\n          bubbles: true\n        }));\n      }\n\n      this._src = value;\n    }); // trigger a set to src whenever assets change\n\n    this._overlay.addEventListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._overlay.removeEventListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  onAssetsChanged() {\n    this.src = this._src;\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-iframe\", OpenOverlayIframe);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayIframe);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/OpenOverlayIframe.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/OpenOverlayImage.js":
/*!***********************************************************!*\
  !*** ./src/browser-renderer/elements/OpenOverlayImage.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities.js */ \"./src/browser-renderer/utilities.js\");\n/* harmony import */ var _elementBase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_elementBase.js */ \"./src/browser-renderer/elements/_elementBase.js\");\n\n\n\n\nclass OpenOverlayImage extends _elementBase_js__WEBPACK_IMPORTED_MODULE_2__.default {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_img\", void 0);\n\n    this._img = document.createElement(\"img\");\n    this._img.style = \"height: 100%; width: 100%; object-fit: inherit; object-position: inherit\";\n    this.getNaturalDimensions = this.getNaturalDimensions.bind(this);\n    this.onAssetsChanged = this.onAssetsChanged.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback(); // append the image\n\n    this.append(this._img);\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"src\", null, () => this._src, value => {\n      // unreference prior asset if needed\n      if (this._src && this._src.startsWith(\"#\")) this.unreferenceAsset(\"src\"); // handle asset references (starting with #)\n\n      if (value != null && value.startsWith(\"#\")) {\n        // ensure assets are available before proceeding\n        if (this._overlay.assetsAvailable()) {\n          const asset = this._overlay.findAsset(value);\n\n          if (asset != null) {\n            this.referenceAsset(\"src\", value);\n            this._img.src = asset.objectUrl;\n          } else {\n            console.error(\"Could not find asset \" + value);\n            this._img.src = null;\n          }\n        }\n      } else {\n        this._img.src = value;\n      }\n\n      this._src = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"objectFit\", null, () => this._objectFit, value => {\n      this._objectFit = value;\n      this._img.style.objectFit = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"objectPosition\", null, () => this._objectPosition, value => {\n      this._objectPosition = value;\n      this._img.style.objectPosition = value;\n    }); // trigger a set to src whenever assets change and we have an active asset reference\n\n    this._overlay.addEventListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._overlay.removeEventListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  onAssetsChanged() {\n    // whenever assets change, re-call the src setter with the existing value to update asset references and stuff\n    this.src = this._src;\n  }\n\n  getNaturalDimensions() {\n    if (!this._img) return null;\n    return {\n      width: this._img.naturalWidth,\n      height: this._img.naturalHeight\n    };\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-image\", OpenOverlayImage);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayImage);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/OpenOverlayImage.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/OpenOverlayRectangle.js":
/*!***************************************************************!*\
  !*** ./src/browser-renderer/elements/OpenOverlayRectangle.js ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _elementBase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_elementBase.js */ \"./src/browser-renderer/elements/_elementBase.js\");\n\n\nclass OpenOverlayRectangle extends _elementBase_js__WEBPACK_IMPORTED_MODULE_0__.default {\n  constructor() {\n    super();\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-rectangle\", OpenOverlayRectangle);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayRectangle);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/OpenOverlayRectangle.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/OpenOverlayText.js":
/*!**********************************************************!*\
  !*** ./src/browser-renderer/elements/OpenOverlayText.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _elementBase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_elementBase.js */ \"./src/browser-renderer/elements/_elementBase.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utilities.js */ \"./src/browser-renderer/utilities.js\");\n\n\n\n\nclass OpenOverlayText extends _elementBase_js__WEBPACK_IMPORTED_MODULE_1__.default {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_textDom\", void 0);\n  }\n\n  connectedCallback() {\n    // default styles\n    if (this.width === undefined) {\n      this.width = 1;\n    }\n\n    if (this.height === undefined) {\n      this.height = 1;\n    }\n\n    this.style.display = \"flex\";\n    this.style.alignItems = \"flex-start\";\n    this.style.justifyContent = \"flex-start\";\n    this.style.whiteSpace = \"pre\"; // styles will be overridden by the _elementBase super class\n\n    super.connectedCallback();\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"text\", \"\", () => this.innerText, value => {\n      this.innerText = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"font\", \"\", () => this._font, value => {\n      this._font = value;\n      this.style.fontFamily = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"fontSrc\", null, () => this._fontSrc, value => {\n      this._fontSrc = value;\n      this.onFontSrcChanged();\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"fontSize\", null, () => this._fontSize, value => {\n      this._fontSize = value;\n      this.style.fontSize = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"fontColor\", null, () => this._fontColor, value => {\n      this._fontColor = value;\n      this.style.color = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"wrap\", null, () => this._wrap, value => {\n      this._wrap = value;\n      this.style.whiteSpace = value ? \"pre-wrap\" : \"pre\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"letterSpacing\", null, () => this._letterSpacing, value => {\n      this._letterSpacing = value;\n      this.style.letterSpacing = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"lineHeight\", null, () => this._lineHeight, value => {\n      this._lineHeight = value;\n      this.style.lineHeight = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"textShadow\", null, () => this._textShadow, value => {\n      this._textShadow = value;\n      this.style.textShadow = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"textStroke\", null, () => this._textStroke, value => {\n      this._textStroke = value;\n      this.style.webkitTextStroke = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"bold\", null, () => this._bold, value => {\n      this._bold = value;\n      this.style.fontWeight = value ? \"bold\" : \"normal\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"italic\", null, () => this._italic, value => {\n      this._italic = value;\n      this.style.fontStyle = value ? \"italic\" : \"normal\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"underline\", null, () => this._underline, value => {\n      this._underline = value;\n      this.style.textDecoration = value ? \"underline\" : \"normal\";\n    }); // \"left\", \"center\", \"right\"\n\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"hAlign\", null, () => this._hAlign, value => {\n      this._hAlign = value;\n\n      switch (value) {\n        case \"left\":\n          this.style.textAlign = \"left\";\n          this.style.justifyContent = \"flex-start\";\n          break;\n\n        case \"center\":\n          this.style.textAlign = \"center\";\n          this.style.justifyContent = \"center\";\n          break;\n\n        case \"right\":\n          this.style.textAlign = \"right\";\n          this.style.justifyContent = \"flex-end\";\n          break;\n\n        default:\n          break;\n      }\n    }); // \"top\", \"center\", \"bottom\"\n\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"vAlign\", null, () => this._vAlign, value => {\n      this._vAlign = value;\n\n      switch (value) {\n        case \"top\":\n          this.style.alignItems = \"flex-start\";\n          break;\n\n        case \"center\":\n          this.style.alignItems = \"center\";\n          break;\n\n        case \"bottom\":\n          this.style.alignItems = \"flex-end\";\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    super.attributeChangedCallback(name, oldValue, newValue);\n  }\n\n  onFontSrcChanged() {\n    // if _fontSrc is not specified, do nothing\n    if (!this._fontSrc) return null;\n    if (!window._loadedFonts) window._loadedFonts = []; // if we've already loaded this font, return immediately\n\n    if (window._loadedFonts.includes(this._fontSrc)) return; // if we've gotten here, we need to load the google font.\n\n    const preloadPromise = (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.loadFont)(this._fontSrc).then(r => {\n      window._loadedFonts.push(this._fontSrc);\n    });\n    this.dispatchEvent(new CustomEvent(\"preloading\", {\n      detail: {\n        promise: preloadPromise\n      },\n      bubbles: true\n    }));\n  }\n\n}\n\nif (window.customElements) customElements.define(\"openoverlay-text\", OpenOverlayText);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (OpenOverlayText);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/OpenOverlayText.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/OpenOverlayVideo.js":
/*!***********************************************************!*\
  !*** ./src/browser-renderer/elements/OpenOverlayVideo.js ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"OpenOverlayVideo\": () => (/* binding */ OpenOverlayVideo),\n/* harmony export */   \"OpenOverlayVideoYouTube\": () => (/* binding */ OpenOverlayVideoYouTube)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _elementBase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_elementBase.js */ \"./src/browser-renderer/elements/_elementBase.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utilities.js */ \"./src/browser-renderer/utilities.js\");\n\n\n\nconst YOUTUBE_URL_REGEX = /.*(?:www\\.youtube\\.com\\/(?:(?:watch\\?v=)|(?:embed\\/))|(?:youtu\\.be\\/))([a-z0-9]+)(?:\\?(?:(?:t)|(?:start))=(\\d+))?/i;\n\nfunction getYoutubeVideoId(url) {\n  const match = url.match(YOUTUBE_URL_REGEX);\n  return match ? match[1] : null;\n}\n\nclass OpenOverlayVideo extends _elementBase_js__WEBPACK_IMPORTED_MODULE_1__.default {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_subelement\", void 0);\n\n    this.ensureSubelement = this.ensureSubelement.bind(this);\n    this.getNaturalDimensions = this.getNaturalDimensions.bind(this);\n    this.onAssetsChanged = this.onAssetsChanged.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"autoplay\", false, () => this._autoplay, value => {\n      this._autoplay = value;\n      if (this._subelement) this._subelement.autoplay = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"src\", null, () => this._src, value => {\n      // unreference prior asset if needed\n      if (this._src && this._src.startsWith(\"#\")) this.unreferenceAsset(\"src\"); // check if this is a youtube video URL\n\n      const youtubeVideoId = getYoutubeVideoId(value);\n      this.ensureSubelement(youtubeVideoId != null);\n      this._subelement.style.objectFit = this._objectFit;\n      this._subelement.style.objectPosition = this._objectPosition;\n      this._subelement.autoplay = this._autoplay;\n      this._subelement.videoId = youtubeVideoId;\n\n      if (!youtubeVideoId) {\n        if (value.startsWith(\"#\")) {\n          if (this._overlay.assetsAvailable()) {\n            const asset = this._overlay.findAsset(value);\n\n            if (asset) {\n              this.referenceAsset(\"src\", value);\n              this._subelement.src = asset ? asset.objectUrl : null;\n            } else {\n              console.error(\"Could not find asset \" + value);\n              this._subelement.src = null;\n            }\n          }\n        } else {\n          this._subelement.src = value;\n        }\n      }\n\n      this._src = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"objectFit\", null, () => this._objectFit, value => {\n      this._objectFit = value;\n      this._img.style.objectFit = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"objectPosition\", null, () => this._objectPosition, value => {\n      this._objectPosition = value;\n      this._img.style.bjectPosition = value;\n    }); // trigger a set to src whenever assets change and we have an active asset reference\n\n    this._overlay.addEventListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._overlay.removeAssetListener(\"assets-changed\", this.onAssetsChanged);\n  }\n\n  onAssetsChanged() {\n    this.src = this._src;\n  }\n\n  ensureSubelement(isYoutube) {\n    if (isYoutube && !(this._subelement instanceof OpenOverlayVideoYouTube)) {\n      if (this._subelement) this.removeChild(this._subelement);\n      this._subelement = document.createElement(\"openoverlay-video-youtube\");\n      this.appendChild(this._subelement);\n    } else if (!isYoutube && !(this._subelement instanceof HTMLVideoElement)) {\n      if (this._subelement) this.removeChild(this._subelement);\n      this._subelement = document.createElement(\"video\");\n      this._subelement.style = \"width:100%;height:100%;\";\n      this.appendChild(this._subelement);\n    }\n  }\n\n  getNaturalDimensions() {\n    // youtube doesn't provide an API to get video sizes (or even aspect ratios), so we'll fix this to a good default\n    // 1280x720 should look good in most cases\n    if (this._subelement instanceof OpenOverlayVideoYouTube) return {\n      width: 1280,\n      height: 720\n    };\n    if (this._subelement instanceof HTMLVideoElement) return {\n      width: this._subelement.videoWidth,\n      height: this._subelement.videoHeight\n    };\n    return null;\n  }\n\n}\n\nclass OpenOverlayVideoYouTube extends HTMLElement {\n  get videoId() {\n    return this._videoId;\n  }\n\n  set videoId(value) {\n    this._videoId = value; // update the youtube player when video changes\n\n    if (this._playerReadyPromise) {\n      this._playerReadyPromise.then(player => {\n        player.loadVideoById(this._videoId);\n      });\n    }\n  }\n\n  get autoplay() {\n    return this._autoplay;\n  }\n\n  set autoplay(value) {\n    this._autoplay = value;\n  }\n\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_target\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_apiReadyPromise\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_playerReadyPromise\", void 0);\n\n    this.attachShadow({\n      mode: \"open\"\n    });\n    this._getVideoUrl = this._getVideoUrl.bind(this);\n    this._ensureYoutubeAPILoaded = this._ensureYoutubeAPILoaded.bind(this);\n    const wrapper = document.createElement(\"div\");\n    wrapper.style = \"overflow:hidden;height:100%;width:100%;\";\n    this.shadowRoot.append(wrapper);\n    const interactionBlocker = document.createElement(\"div\");\n    interactionBlocker.style = \"position:absolute;top:0;left:0;width:100%;height:100%;\";\n    wrapper.append(interactionBlocker);\n    const target = document.createElement(\"div\");\n    wrapper.append(target);\n    this._target = target;\n\n    this._ensureYoutubeAPILoaded();\n  }\n\n  _getVideoUrl() {\n    return `http://www.youtube.com/v/${this._videoId}?version=3`;\n  }\n\n  _ensureYoutubeAPILoaded() {\n    this._apiReadyPromise = new Promise(resolve => {\n      // if window.YT is defined, we're already loaded\n      if (window.YT) {\n        resolve();\n        return;\n      } // look through the header for the API script to determine if some other code is currently loading the youtube API script\n      // otherwise, we need to load the iframe API\n\n\n      let youtubeApiScriptElement = document.querySelector(\"script[src='https://www.youtube.com/iframe_api']\");\n\n      if (!youtubeApiScriptElement) {\n        youtubeApiScriptElement = document.createElement(\"script\");\n        youtubeApiScriptElement.src = \"https://www.youtube.com/iframe_api\";\n        document.head.append(youtubeApiScriptElement);\n      }\n\n      if (window.onYouTubeIframeAPIReady) {\n        const existingApiReadyFunction = window.onYouTubeIframeAPIReady;\n\n        window.onYouTubeIframeAPIReady = () => {\n          existingApiReadyFunction();\n          resolve();\n        };\n      } else {\n        window.onYouTubeIframeAPIReady = resolve;\n      }\n    }); // dispatch a preloading event so the overlay won't show until we've got something to render\n\n    this.dispatchEvent(new CustomEvent(\"preloading\", {\n      detail: {\n        promise: this._apiReadyPromise\n      },\n      bubbles: true\n    }));\n  }\n\n  connectedCallback() {\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"videoId\", null, () => this._videoId, value => {\n      this._videoId = value; // update the youtube player when video changes\n\n      if (this._playerReadyPromise) {\n        this._playerReadyPromise.then(player => {\n          if (this._videoId) {\n            if (this._autoplay) player.loadVideoById(this._videoId);else player.cueVideoById(this._videoId);\n          } else {\n            player.stopVideo();\n          }\n        });\n      }\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_2__.makeProperty)(this, \"autoplay\", null, () => this._autoplay, value => {\n      this._autoplay = value;\n    });\n    this._playerReadyPromise = new Promise(resolve => {\n      this._apiReadyPromise.then(() => {\n        const player = new YT.Player(this._target, {\n          width: \"100%\",\n          height: \"100%\",\n          playerVars: {\n            'controls': 0,\n            'modestbranding': 1\n          },\n          events: {\n            onReady: () => {\n              resolve(player);\n            }\n          }\n        });\n      });\n    });\n    this.dispatchEvent(new CustomEvent(\"preloading\", {\n      detail: {\n        promise: this._playerReadyPromise\n      },\n      bubbles: true\n    }));\n  }\n\n  disconnectedCallback() {}\n\n}\n\nif (window.customElements) {\n  customElements.define(\"openoverlay-video\", OpenOverlayVideo);\n  customElements.define(\"openoverlay-video-youtube\", OpenOverlayVideoYouTube);\n}\n\n\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/OpenOverlayVideo.js?");

/***/ }),

/***/ "./src/browser-renderer/elements/_elementBase.js":
/*!*******************************************************!*\
  !*** ./src/browser-renderer/elements/_elementBase.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ \"./node_modules/@babel/runtime/helpers/esm/defineProperty.js\");\n/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities.js */ \"./src/browser-renderer/utilities.js\");\n\n\n\nclass _elementBase extends HTMLElement {\n  constructor() {\n    super();\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_name\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_overlay\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_assetReferences\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_initialized\", void 0);\n\n    (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.default)(this, \"_hostStyle\", void 0);\n\n    this._assetReferences = {}; //this.attachShadow({ mode: \"open\" });\n    // set the default style for this element\n    //const style = document.createElement(\"style\");\n    //style.textContent = \":host { display: block; position: absolute; box-sizing: border-box; object-fit: contain; object-position: center center; } :host([hidden]) { display: none; }\";\n    //this.shadowRoot.append(style);\n  }\n\n  connectedCallback() {\n    this._initialized = true;\n    this._overlay = this.closest(\"openoverlay-overlay\");\n    if (!this._overlay) throw \"Layer elements must be a descendant of an openoverlay-overlay element.\"; // set up common properties\n\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"top\", 0, () => this._top, value => {\n      this._top = value;\n      this.style.top = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"left\", 0, () => this._left, value => {\n      this._left = value;\n      this.style.left = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"width\", 0, () => this._width, value => {\n      this._width = value;\n      this.style.width = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"height\", 0, () => this._height, value => {\n      this._height = value;\n      this.style.height = value + \"px\";\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"backgroundColor\", null, () => this._backgroundColor, value => {\n      this._backgroundColor = value;\n      this.style.backgroundColor = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"border\", null, () => this._border, value => {\n      this._border = value;\n      this.style.border = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"opacity\", null, () => this._opacity, value => {\n      this._opacity = value;\n      this.style.opacity = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"boxShadow\", null, () => this._boxShadow, value => {\n      this._boxShadow = value;\n      this.style.boxShadow = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"filter\", null, () => this._filter, value => {\n      this._filter = value;\n      this.style.filter = value;\n    });\n    (0,_utilities_js__WEBPACK_IMPORTED_MODULE_1__.makeProperty)(this, \"transform\", null, () => this._transform, value => {\n      this._transform = value;\n      this.style.transform = value;\n    });\n  }\n\n  disconnectedCallback() {}\n\n  referenceAsset(key, id) {\n    this._assetReferences[key] = id;\n  }\n\n  unreferenceAsset(key) {\n    delete this._assetReferences[key];\n  }\n\n  hasAssetReference(key) {\n    return this._assetReferences[key] != null;\n  }\n\n  getAssetReferences() {\n    return Object.values(this._assetReferences);\n  }\n\n} // this is a base class, no need to register with customElements\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_elementBase);\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/elements/_elementBase.js?");

/***/ }),

/***/ "./src/browser-renderer/index.js":
/*!***************************************!*\
  !*** ./src/browser-renderer/index.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _OpenOverlayStage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OpenOverlayStage.js */ \"./src/browser-renderer/OpenOverlayStage.js\");\n/* harmony import */ var _OpenOverlayRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OpenOverlayRenderer.js */ \"./src/browser-renderer/OpenOverlayRenderer.js\");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  OpenOverlayStage: _OpenOverlayStage_js__WEBPACK_IMPORTED_MODULE_0__.default,\n  OpenOverlayRenderer: _OpenOverlayRenderer_js__WEBPACK_IMPORTED_MODULE_1__.default\n});\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/index.js?");

/***/ }),

/***/ "./src/browser-renderer/jsonRenderer.js":
/*!**********************************************!*\
  !*** ./src/browser-renderer/jsonRenderer.js ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"renderOverlayArray\": () => (/* binding */ renderOverlayArray),\n/* harmony export */   \"renderOverlay\": () => (/* binding */ renderOverlay),\n/* harmony export */   \"renderLayer\": () => (/* binding */ renderLayer)\n/* harmony export */ });\n/* harmony import */ var _elements_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./elements.js */ \"./src/browser-renderer/elements.js\");\n // merges array of json objects into the DOM\n// each item must have an \"id\" property\n\nfunction mergeDOM(parentDOM, items, onCreateUpdate) {\n  // grab our DOM child elements\n  let children = parentDOM.children; // check for array length matching up front\n  // pruning up front will make adding/updating faster and the check is cheap.\n  // note that when replacing items, this check will fail and pruning will happen AFTER adding/updating\n\n  if (children.length > items.length) pruneChildren(children, items); // add or update each item\n\n  items.forEach((item, arrayIndex) => {\n    const domIndex = findChildIndexById(children, item.id);\n    let itemDOM = domIndex == -1 ? null : children[domIndex]; // if itemDOM's srcObject matches this item, it doesn't need an update\n    // inversely, we need to update if itemDOM is null or the srcObject is different than item\n\n    if (!itemDOM || itemDOM.srcObject != item) {\n      itemDOM = onCreateUpdate(item, itemDOM); // if itemDOM is null after calling onCreateUpdate, there's an error.  bail out.\n\n      if (!itemDOM) return; // otherwise, update srcObject\n\n      itemDOM.srcObject = item; // ensure zIndex is set (reverse order - first on top!)\n\n      /*\r\n      const zIndex = 10000 - arrayIndex;\r\n      if (itemDOM.style.zIndex != zIndex)\r\n          itemDOM.style.zIndex = zIndex;\r\n      */\n    }\n\n    if (domIndex == -1) {\n      // if we're adding, ensure itemDOM has an ID specified\n      itemDOM.id = item.id; // insert the new DOM element\n\n      if (arrayIndex < children.length) parentDOM.insertBefore(itemDOM, children[arrayIndex]);else parentDOM.appendChild(itemDOM);\n    } else if (domIndex != arrayIndex) {\n      // we need to move the itemDOM to a new location\n      // this one call will simultaneously remove and re-insert\n      parentDOM.insertBefore(itemDOM, children[arrayIndex]);\n    } else {// do nothing - itemDOM has been updated and doesn't need to be moved\n    }\n  }); // check for array length again - if they don't match because we REPLACED an element, then we'll prune\n\n  if (children.length > items.length) pruneChildren(children, items);\n}\n\nfunction pruneChildren(children, items) {\n  // first, remove any items that are missing if necessary\n  const idsToKeep = items.map(r => r.id); // collect the children to remove in an array (can't modify the array in this loop)\n\n  let childrenToRemove = [];\n\n  for (const child of children) {\n    if (!idsToKeep.includes(child.id)) {\n      childrenToRemove.push(child);\n    }\n  } // and finally remove them from the DOM\n\n\n  for (const child of childrenToRemove) child.remove();\n}\n\nfunction findChildIndexById(nodeList, id) {\n  for (let i = 0; i < nodeList.length; i++) {\n    if (nodeList[i].id == id) return i;\n  }\n\n  return -1;\n}\n\nfunction renderOverlayArray(containerDOM, overlayArray) {\n  mergeDOM(containerDOM, overlayArray, renderOverlay);\n}\n\nfunction renderOverlay(overlay, overlayDOM) {\n  if (!overlayDOM) overlayDOM = document.createElement(\"openoverlay-overlay\"); // if overlayDOM's srcObject matches this overlay, skip it - no need to update\n\n  if (overlayDOM.srcObject == overlay) return overlayDOM;\n  overlayDOM.assets = overlay.assets;\n  overlayDOM.scripts = overlay.scripts;\n  overlayDOM.settings = overlay.settings;\n  overlayDOM.executeScriptsOnLoad = overlay.executeScriptsOnLoad; // merge the dom with the object model for layers\n\n  mergeDOM(overlayDOM, overlay.layers, renderLayer); // update the srcObject property for later\n\n  overlayDOM.srcObject = overlay;\n  return overlayDOM;\n}\n\nfunction renderLayer(layer, layerDOM) {\n  if (!layer.elementName) {\n    console.error(\"Layer has no elementName specified.\");\n    return;\n  }\n\n  const element = _elements_js__WEBPACK_IMPORTED_MODULE_0__.default[layer.elementName];\n\n  if (!element) {\n    console.error(\"Could not resolve element \" + layer.elementName);\n    return;\n  }\n\n  if (!layerDOM) {\n    layerDOM = document.createElement(element.domElementName);\n    layerDOM.element = element;\n  } // if layerDOM's srcObject matches this layer, skip it\n\n\n  if (layerDOM.srcObject == layer) return layerDOM; // apply all properties, regardless if they changed\n\n  for (const [propName, propValue] of Object.entries(layer)) {\n    switch (propName) {\n      case \"id\":\n      case \"elementName\":\n      case \"label\":\n        // ignored properties\n        break;\n\n      default:\n        layerDOM[propName] = propValue;\n        break;\n    }\n  }\n\n  return layerDOM;\n}\n\n\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/jsonRenderer.js?");

/***/ }),

/***/ "./src/browser-renderer/utilities.js":
/*!*******************************************!*\
  !*** ./src/browser-renderer/utilities.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"makeProperty\": () => (/* binding */ makeProperty),\n/* harmony export */   \"loadFont\": () => (/* binding */ loadFont)\n/* harmony export */ });\nfunction makeProperty(component, propName, defaultValue, getOverride, setOverride) {\n  let existingValue;\n\n  if (component.hasOwnProperty(propName)) {\n    existingValue = component[propName];\n    delete component[propName];\n  } // define the getters and setters\n\n\n  const internalPropName = \"_\" + propName;\n  Object.defineProperty(component, propName, {\n    get() {\n      return getOverride ? getOverride() : component[internalPropName];\n    },\n\n    set(value) {\n      if (setOverride) setOverride(value);else component[internalPropName] = value;\n    }\n\n  });\n  const initialValue = existingValue != undefined ? existingValue : defaultValue;\n  if (initialValue != undefined) component[propName] = initialValue;\n}\n\nasync function loadFont(url) {\n  await new Promise((resolve, reject) => {\n    let link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = url;\n    link.addEventListener(\"load\", resolve);\n    link.addEventListener(\"abort\", reject);\n    link.addEventListener(\"error\", reject);\n    document.head.appendChild(link);\n  });\n}\n\n\n\n//# sourceURL=webpack://OverlayEditor/./src/browser-renderer/utilities.js?");

/***/ })

}]);